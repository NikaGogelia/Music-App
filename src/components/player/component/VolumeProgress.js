import { useState, useEffect, useRef } from "react";

function VolumeProgress() {
  const [volumeP, setVolumeP] = useState(20);
  const [volume, setVolume] = useState(true);

  const volumeProgress = useRef();

  useEffect(() => {
    if (volume === false) {
      setVolumeP(0);
      volumeProgress.current.style = "background-size: 0% 100%";
    }
  }, [volume, volumeP]);

  return (
    <div className="volume-progress d-flex align-items-center">
      <button className="volume-toggler" onClick={() => setVolume(!volume)}>
        {volume ? (
          <svg
            width={18}
            height={16}
            viewBox="0 0 18 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M8.383 1.076C8.56569 1.15175 8.72181 1.27996 8.83163 1.44443C8.94146 1.6089 9.00005 1.80224 9 2V14C8.99996 14.1978 8.94129 14.3911 8.8314 14.5555C8.72152 14.7199 8.56535 14.848 8.38265 14.9237C8.19995 14.9993 7.99892 15.0192 7.80497 14.9806C7.61102 14.942 7.43285 14.8468 7.293 14.707L3.586 11H1C0.734784 11 0.48043 10.8946 0.292893 10.7071C0.105357 10.5196 0 10.2652 0 10V6C0 5.73479 0.105357 5.48043 0.292893 5.2929C0.48043 5.10536 0.734784 5 1 5H3.586L7.293 1.293C7.43285 1.15307 7.61105 1.05776 7.80508 1.01913C7.9991 0.980506 8.20023 1.0003 8.383 1.076ZM13.657 0.929002C13.8445 0.741531 14.0988 0.636215 14.364 0.636215C14.6292 0.636215 14.8835 0.741531 15.071 0.929002C16.0008 1.85665 16.7382 2.95886 17.2409 4.17231C17.7435 5.38576 18.0015 6.68656 18 8C18.0015 9.31344 17.7435 10.6142 17.2409 11.8277C16.7382 13.0411 16.0008 14.1433 15.071 15.071C14.8824 15.2532 14.6298 15.354 14.3676 15.3517C14.1054 15.3494 13.8546 15.2442 13.6692 15.0588C13.4838 14.8734 13.3786 14.6226 13.3763 14.3604C13.374 14.0982 13.4748 13.8456 13.657 13.657C14.4011 12.9151 14.9912 12.0333 15.3933 11.0624C15.7955 10.0916 16.0016 9.05083 16 8C16 5.79 15.106 3.792 13.657 2.343C13.4695 2.15547 13.3642 1.90117 13.3642 1.636C13.3642 1.37084 13.4695 1.11653 13.657 0.929002ZM10.828 3.757C10.9209 3.66403 11.0312 3.59027 11.1526 3.53994C11.274 3.48962 11.4041 3.46371 11.5355 3.46371C11.6669 3.46371 11.797 3.48962 11.9184 3.53994C12.0398 3.59027 12.1501 3.66403 12.243 3.757C12.8009 4.31367 13.2433 4.97507 13.5448 5.70321C13.8463 6.43136 14.001 7.2119 14 8C14.001 8.7881 13.8463 9.56862 13.5447 10.2968C13.2432 11.0249 12.8008 11.6863 12.243 12.243C12.0554 12.4306 11.8009 12.5361 11.5355 12.5361C11.2701 12.5361 11.0156 12.4306 10.828 12.243C10.6404 12.0554 10.5349 11.8009 10.5349 11.5355C10.5349 11.2701 10.6404 11.0156 10.828 10.828C11.2002 10.4572 11.4953 10.0164 11.6965 9.53106C11.8976 9.04572 12.0008 8.52538 12 8C12.0008 7.47462 11.8977 6.95427 11.6965 6.46891C11.4954 5.98356 11.2002 5.54279 10.828 5.172C10.735 5.07913 10.6613 4.96884 10.6109 4.84744C10.5606 4.72604 10.5347 4.59592 10.5347 4.4645C10.5347 4.33309 10.5606 4.20296 10.6109 4.08156C10.6613 3.96016 10.735 3.84987 10.828 3.757Z"
              fill="#F3F4F6"
            />
          </svg>
        ) : (
          <svg
            width={18}
            height={14}
            viewBox="0 0 18 14"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M8.383 0.0759938C8.56569 0.151738 8.72181 0.27995 8.83163 0.444419C8.94146 0.608888 9.00005 0.802228 9 0.999994V13C8.99996 13.1977 8.94129 13.391 8.8314 13.5555C8.72152 13.7199 8.56535 13.848 8.38265 13.9237C8.19995 13.9993 7.99892 14.0191 7.80497 13.9806C7.61102 13.942 7.43285 13.8468 7.293 13.707L3.586 9.99999H1C0.734784 9.99999 0.48043 9.89464 0.292893 9.7071C0.105357 9.51956 0 9.26521 0 8.99999V4.99999C0 4.73478 0.105357 4.48042 0.292893 4.29289C0.48043 4.10535 0.734784 3.99999 1 3.99999H3.586L7.293 0.292994C7.43285 0.153061 7.61105 0.057752 7.80508 0.019125C7.9991 -0.019502 8.20023 0.000289015 8.383 0.0759938ZM11.293 4.29299C11.4805 4.10552 11.7348 4.00021 12 4.00021C12.2652 4.00021 12.5195 4.10552 12.707 4.29299L14 5.58599L15.293 4.29299C15.3852 4.19748 15.4956 4.1213 15.6176 4.06889C15.7396 4.01648 15.8708 3.9889 16.0036 3.98774C16.1364 3.98659 16.2681 4.01189 16.391 4.06217C16.5138 4.11245 16.6255 4.18671 16.7194 4.2806C16.8133 4.37449 16.8875 4.48614 16.9378 4.60904C16.9881 4.73194 17.0134 4.86362 17.0123 4.9964C17.0111 5.12917 16.9835 5.26039 16.9311 5.3824C16.8787 5.5044 16.8025 5.61475 16.707 5.70699L15.414 6.99999L16.707 8.29299C16.8892 8.4816 16.99 8.7342 16.9877 8.9964C16.9854 9.25859 16.8802 9.50941 16.6948 9.69481C16.5094 9.88022 16.2586 9.98539 15.9964 9.98767C15.7342 9.98995 15.4816 9.88915 15.293 9.70699L14 8.41399L12.707 9.70699C12.5184 9.88915 12.2658 9.98995 12.0036 9.98767C11.7414 9.98539 11.4906 9.88022 11.3052 9.69481C11.1198 9.50941 11.0146 9.25859 11.0123 8.9964C11.01 8.7342 11.1108 8.4816 11.293 8.29299L12.586 6.99999L11.293 5.70699C11.1055 5.51947 11.0002 5.26516 11.0002 4.99999C11.0002 4.73483 11.1055 4.48052 11.293 4.29299Z"
              fill="#F3F4F6"
            />
          </svg>
        )}
      </button>
      <input
        style={{ backgroundSize: `${volumeP - 0.5}% 100%` }}
        type="range"
        name="v-progress"
        id="v-progress"
        className="v-progress"
        min={1}
        max={100}
        ref={volumeProgress}
        value={volumeP}
        onChange={(e) =>
          volume === false ? undefined : setVolumeP(e.target.value)
        }
      />
    </div>
  );
}

export default VolumeProgress;
